<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../2018-10-20-AMES-tutorial/ rel=prev><link href=../../awards_CV/ rel=next><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.4.2, mkdocs-material-9.0.13"><title>2017 Bitcoin Bubble - Time series forecasting - Joe Ganser - Data Technologist, Teacher & Fitness junky</title><link rel=stylesheet href=../../assets/stylesheets/main.ffa9267a.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.a0c5b2b5.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../stylesheets/extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#before-the-bitcoin-bubble-burst-predicting-day-to-day-prices-with-arima-neural-nets class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Joe Ganser - Data Technologist, Teacher & Fitness junky" class="md-header__button md-logo" aria-label="Joe Ganser - Data Technologist, Teacher & Fitness junky" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Joe Ganser - Data Technologist, Teacher & Fitness junky </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 2017 Bitcoin Bubble - Time series forecasting </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/JoeGanser title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../curriculum_vitae/ class=md-tabs__link> Curriculum Vitae </a> </li> <li class=md-tabs__item> <a href=../2022-8-2_dengu/ class="md-tabs__link md-tabs__link--active"> Research Projects </a> </li> <li class=md-tabs__item> <a href=../../awards_CV/ class=md-tabs__link> Awards </a> </li> <li class=md-tabs__item> <a href=../../teaching_CV/ class=md-tabs__link> Courses Taught </a> </li> <li class=md-tabs__item> <a href=../../confrences/ class=md-tabs__link> Scientific Confrences </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Joe Ganser - Data Technologist, Teacher & Fitness junky" class="md-nav__button md-logo" aria-label="Joe Ganser - Data Technologist, Teacher & Fitness junky" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> Joe Ganser - Data Technologist, Teacher & Fitness junky </label> <div class=md-nav__source> <a href=https://github.com/JoeGanser title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class=md-nav__item> <a href=../../curriculum_vitae/ class=md-nav__link> Curriculum Vitae </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> Research Projects <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=true> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Research Projects </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../2022-8-2_dengu/ class=md-nav__link> Driven Data Competiton - Predicintg Dengu Fever </a> </li> <li class=md-nav__item> <a href=../2019-4-22-Tinder-Gold%3B-Big-Data-For-Big-Dating-1st-place-competition/ class=md-nav__link> Big Data For Big Dating - 1st place Tinder Competition </a> </li> <li class=md-nav__item> <a href=../2019-4-1-Predicting-Breathing-rate-with-smart-watch-data/ class=md-nav__link> Predicting Breathing rate with Smart Watch Data </a> </li> <li class=md-nav__item> <a href=../2019-3-24-Fraud-Analytics/ class=md-nav__link> Predicting Fraud & Other Crimes across the USA </a> </li> <li class=md-nav__item> <a href=../2019-1-26-superconductivity-regression/ class=md-nav__link> Superconductors - using material data to predict critical temperature </a> </li> <li class=md-nav__item> <a href=../2018-12-15-mushroom-classification/ class=md-nav__link> Mushroom Data - edible or poisonous? </a> </li> <li class=md-nav__item> <a href=../2018-10-20-AMES-tutorial/ class=md-nav__link> Real Estate Sales - A basic regression tutorial </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> 2017 Bitcoin Bubble - Time series forecasting <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> 2017 Bitcoin Bubble - Time series forecasting </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#abstract class=md-nav__link> Abstract </a> </li> <li class=md-nav__item> <a href=#iintroduction class=md-nav__link> I.Introduction </a> </li> <li class=md-nav__item> <a href=#iimodel-choices-arima-neural-net-recursion class=md-nav__link> II.Model Choices: ARIMA &amp; Neural Net Recursion </a> </li> <li class=md-nav__item> <a href=#iii-model-evluation class=md-nav__link> III. Model Evluation </a> </li> <li class=md-nav__item> <a href=#iv-model-code class=md-nav__link> IV: Model Code </a> </li> <li class=md-nav__item> <a href=#v-sources class=md-nav__link> V. Sources </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../awards_CV/ class=md-nav__link> Awards </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> Courses Taught <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Courses Taught </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../teaching_CV/ class=md-nav__link> Teaching Experiences </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2> <label class=md-nav__link for=__nav_5_2 id=__nav_5_2_label tabindex=0> Python for Data Science <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Python for Data Science </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../teaching/syllabi/ds542syllabus/ds542syllabus.pdf class=md-nav__link> Syllabus </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_3> <label class=md-nav__link for=__nav_5_3 id=__nav_5_3_label tabindex=0> Big Data Computing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_3_label aria-expanded=false> <label class=md-nav__title for=__nav_5_3> <span class="md-nav__icon md-icon"></span> Big Data Computing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../teaching/syllabi/DS610Syllabus/DS610SyllabusMaster_1_.docx.html class=md-nav__link> Syllabus </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_4> <label class=md-nav__link for=__nav_5_4 id=__nav_5_4_label tabindex=0> Advanced Programming for AI & Big Data <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_5_4> <span class="md-nav__icon md-icon"></span> Advanced Programming for AI & Big Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../teaching/syllabi/BDS4440_Syllabus/BDS4440_Syllabus.html class=md-nav__link> Syllabus </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../confrences/ class=md-nav__link> Scientific Confrences </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#abstract class=md-nav__link> Abstract </a> </li> <li class=md-nav__item> <a href=#iintroduction class=md-nav__link> I.Introduction </a> </li> <li class=md-nav__item> <a href=#iimodel-choices-arima-neural-net-recursion class=md-nav__link> II.Model Choices: ARIMA &amp; Neural Net Recursion </a> </li> <li class=md-nav__item> <a href=#iii-model-evluation class=md-nav__link> III. Model Evluation </a> </li> <li class=md-nav__item> <a href=#iv-model-code class=md-nav__link> IV: Model Code </a> </li> <li class=md-nav__item> <a href=#v-sources class=md-nav__link> V. Sources </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=before-the-bitcoin-bubble-burst-predicting-day-to-day-prices-with-arima-neural-nets><strong>Before the Bitcoin Bubble Burst: Predicting day to day prices with ARIMA &amp; Neural Nets</strong><a class=headerlink href=#before-the-bitcoin-bubble-burst-predicting-day-to-day-prices-with-arima-neural-nets title="Permanent link">&para;</a></h1> <p><strong>Joe Ganser</strong> </p> <h2 id=abstract><strong>Abstract</strong><a class=headerlink href=#abstract title="Permanent link">&para;</a></h2> <p>The objective of this blog post is to experiment with time series techniques as well as methods in signal/noise extraction to make a prediction on the prices of both bitcoin and ethereum in the last week of August 2017, using all the previous pricing data.</p> <p>In this short term price forecast, I am predicting the next day's price based upon all the prices leading upto it. Then on the next day, I am repeating this process again, once next day's price is received. Model techniques like this could be used for high frequency trading, not long term investing. This is NOT about predicting long term trends.</p> <p>Because I am only predicting the next day out, and I am extracting the signal from the noise and what the models ACTUALLY predict is the noise. The predicted noise is then plugged back into the signal function, and that turns into the measurable prediction. This concept is explained a little more below.</p> <p>Lets take a look at the pricing data upto this point so far;</p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/fullplots.png> </p> <h2 id=iintroduction>I.Introduction<a class=headerlink href=#iintroduction title="Permanent link">&para;</a></h2> <p><strong>WORKFLOW</strong></p> <p>The general process of how I built my models can be summarized in a few steps.</p> <ol> <li> <p>Extract the signal from the noise (find stationarity via dickey fuller test). More about this below.</p> </li> <li> <p>Model the noise, and predict the noise for the next day (ARIMA and Neural nets)</p> </li> <li> <p>Plug the predicted noise into the signal, calculating the price value for the next day</p> </li> <li> <p>Compare the predicted price of the next day to the actual next day's price</p> </li> <li> <p>Repeat steps 2 and 3 once when obtaining the actual price of the next day (use a for loop)</p> </li> </ol> <h2 id=iimodel-choices-arima-neural-net-recursion><strong>II.Model Choices: ARIMA &amp; Neural Net Recursion</strong><a class=headerlink href=#iimodel-choices-arima-neural-net-recursion title="Permanent link">&para;</a></h2> <p>The model choice was done simply for comparitive experimental reasons, only because ARIMA and Neural Net LSTM can predict time series. Other techniques could be done to, but I just wanted to compare these out of curiosity. Their performance metrics were the cumulative root mean square error across all the days predicted.</p> <p><strong>ASSUMPTIONS</strong></p> <p>The assumption, which is validated, is that the exponential long term trend shall remain over the last few days of August of 2017. The assumption was made through the techniques of signal noise extraction which are explained below. I do NOT assume that the exponential trend will go on forever.</p> <p><strong>MODEL PREDICTIONS</strong></p> <p>Here are the final results - the actual predictions of my models.</p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/predictions.png></p> <p><strong>Predictions for Bitcoin</strong></p> <table> <thead> <tr> <th>Date</th> <th>Bitcoin Price</th> <th>ARIMA prediction</th> <th>Neural Net Prediction</th> </tr> </thead> <tbody> <tr> <td>2017-08-23</td> <td>4318.35</td> <td>4321.92</td> <td>4369.75</td> </tr> <tr> <td>2017-08-24</td> <td>4364.41</td> <td>4368.25</td> <td>4423.16</td> </tr> <tr> <td>2017-08-25</td> <td>4352.30</td> <td>4356.23</td> <td>4397.79</td> </tr> <tr> <td>2017-08-26</td> <td>4345.75</td> <td>4349.69</td> <td>4384.69</td> </tr> <tr> <td>2017-08-27</td> <td>4390.31</td> <td>4394.20</td> <td>4430.15</td> </tr> <tr> <td>2017-08-28</td> <td>4597.31</td> <td>4601.04</td> <td>4643.98</td> </tr> <tr> <td>2017-08-29</td> <td>4583.02</td> <td>4587.37</td> <td>4643.36</td> </tr> </tbody> </table> <p><strong>Predictions for Ethereum</strong></p> <table> <thead> <tr> <th>Date</th> <th>Ethereum Price</th> <th>ARIMA prediction</th> <th>Neural Net Prediction</th> </tr> </thead> <tbody> <tr> <td>2017-08-23</td> <td>325.28</td> <td>327.39</td> <td>325.36</td> </tr> <tr> <td>2017-08-24</td> <td>330.06</td> <td>331.70</td> <td>325.76</td> </tr> <tr> <td>2017-08-25</td> <td>332.86</td> <td>334.69</td> <td>334.74</td> </tr> <tr> <td>2017-08-26</td> <td>347.88</td> <td>350.00</td> <td>352.49</td> </tr> <tr> <td>2017-08-27</td> <td>347.66</td> <td>348.96</td> <td>350.64</td> </tr> <tr> <td>2017-08-28</td> <td>372.35</td> <td>374.69</td> <td>373.62</td> </tr> <tr> <td>2017-08-29</td> <td>383.86</td> <td>384.72</td> <td>388.87</td> </tr> </tbody> </table> <h2 id=iii-model-evluation><strong>III. Model Evluation</strong><a class=headerlink href=#iii-model-evluation title="Permanent link">&para;</a></h2> <p>So looking at these results, what were the model performance metrics? The performance metric I used to compare the results of the techniques was the summed root mean square error across all the days (seven, in total) predicted.</p> <table> <thead> <tr> <th><strong>Model</strong></th> <th><strong>Bitcoin RMSE</strong></th> <th><strong>Ethereum RMSE</strong></th> </tr> </thead> <tbody> <tr> <td>ARIMA</td> <td>3.8985</td> <td>9.73758</td> </tr> <tr> <td>Neural Net</td> <td>49.40448</td> <td>1.67389</td> </tr> </tbody> </table> <p>Cumulative across the dates of Aug 23-Aug 29 2017.</p> <p><strong>Interesting Results!</strong></p> <p>ARIMA tended to perform better on bitcoin than neural nets, but the neural nets performed much better on the ethereum data! This may be related to the signal function I used, which is explained below.</p> <p><strong>EXTRACTING THE SIGNAL FROM THE NOISE USING THE AUGMENTED DICKEY FULLER TEST</strong></p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/Signal_Noise.png></p> <p>The <a href=https://en.wikipedia.org/wiki/Augmented_Dickeyâ€“Fuller_test>augmented dickey fuller</a> test is a statistical test to determine <a href=https://en.wikipedia.org/wiki/Stationary_process>stationarity</a>. Stationarity occurs when a series of data is transformed into format which clearly identifies the signal (aka a "trend") and all we are left with is noise. More specifically, stationarity occurs when we put the time series data is put into it's correct inverse function. With outputs similar to a Z-test, the test tells us if the new format we have has clearly identified the signal within the data. The null hypothesis of the Dickey Fuller test is that the signal and noise are NOT decoupled. The strategy behind using this is that by extracting the signal, we model and predict the noise and plug those predictions back into the signal.</p> <p>Stationarity data has four fundamental criteria:</p> <p><img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/stationarity_criteria.png width=80% height=80%></p> <p><strong>THE BEST FIT FUNCTION &amp; IT'S INVERSE</strong></p> <p>Knowing the best fitting function is not enough to model the time series. What is needed is not only a best fit function, but that function's inverse as well. By putting the data of the time series into the inverse function, we can get the noise values. It's noise values that are put into the Dickey Fuller test.</p> <p><em>A graphical example of an inverse function:</em> log(x) is the inverse of e^(x)</p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/InverseFunction.png></p> <p>Extracting the signal from the noise can be summed into three steps</p> <ol> <li>Find the a function similar to the time series data.</li> <li>Find that function's inverse.</li> <li> <p>Plug the time series data into the inverse, and plug that transformed data set into the Dickey Fuller Test</p> <p>*If we haven't rejected the null hypothesis in step 3 try step 1 over starting with a different function.</p> </li> </ol> <p>By looking at the very first plot, we can see that the trend of the cryptocurrency prices are in some way exponential. Thus, I can hypothesize that the signal is exponential in form.</p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/bitprice_vs_exponential_curve.png></p> <p>The actual function form that allowed me to seperate the signal from the noise was indeed <em>exponential in form</em> but not simply exponential. It was by using this function's inverse that I could pass the dickey fuller test.</p> <p>The actual function that worked was this:</p> <p><img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/function_definition.png width=30% height=30%></p> <p>These function transformations worked with both the bitcoin &amp; ethereum data.</p> <p>In code form, it is:</p> <p><code>noise = (np.log(data['Price'])-np.log(data['Price'].shift())).dropna()</code></p> <p>Where the <code>'.shift()'</code> cooresponds to the day before.</p> <p><strong>FAILING AND THEN PASSING THE DICKEY FULLER TEST</strong></p> <p>In the images passing the Dickey Fuller test without perfmoring any transformation, and then (botton of each tab), the Dickey Fuller test is passed (meaning we can reject the null hypothesis, and the data is stationary.)</p> <p>So now I have clearly identified the stationary form of the time series. These stationary forms can be plugged into the models to predict the noise, and using the noise predictions we can plug those back into the signal.</p> <p>The plots below show the series, the rolling mean and standard deviations plotted side by side. The first is what the original series looked like, and the second is what the series looks like after it's input into the inverse transformation function.</p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/Dickey_Fuller_Tests.png></p> <p>The specific statistics for the tests were:</p> <p>Bitcoin Dickey-Fuller Test:|Results when transformed to stationary|Results results before stationary (failing) ------|---------|--------| Test Statistic|-20.254025|3.433511 p-value|0.000000|1.00000 Number Lags Used|4.000000|28.0000 Number of Observations Used| 2596.000000|2573.000000 Critical Value (1%)|-3.962262|-3.962293 Critical Value (5%)|-3.412183|-3.412198 Critical Value (10%)|-3.128047|-3.128055</p> <h2 id=iv-model-code><strong>IV: Model Code</strong><a class=headerlink href=#iv-model-code title="Permanent link">&para;</a></h2> <p><strong>So the prediction steps are structured in a FOR LOOP:</strong></p> <ol> <li>Plug the noise into the model</li> <li>Train the model on the history of the noise</li> <li>Predict the noise of the next day</li> <li>Plug the next day's predicted noise into the signal function.</li> <li>Add the actual price of the next day to the price data set, transform it into stationarity and start again at step 1.</li> </ol> <p><strong>MODELLING WITH ARIMA</strong></p> <p>There are several steps to building an ARIMA model. ARIMA operates on three parameters. Based upon the plots of auto-correlation, partial auto-correlation and the amount of Bayesian information criterion we select these three parameters. Ofcourse, the end goal is to minimize the root mean squared error of the model.</p> <p><strong>AUTO CORRELATION &amp; PARTIAL AUTOCORRELATION PLOTS</strong></p> <p>The plots of auto-correlation &amp; partial auto-correlation for bitcoin &amp; ethereums stationary formats were:</p> <p align=center> <img src=https://raw.githubusercontent.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum/master/Crypto_8_2017_Files/correlation_plots.png></p> <p>Using these plots I can estimate the ARIMA parameters (p,q) of the parameters (p,q,d) for ARIMA models. Just by looking at the graphs it can be estimate that p &amp; q are around no more than 7 each. After grid searching through lots of combinations it was found that <strong>Bitcoins ARIMA parameters were (p=0,d=1,q=1)</strong> and <strong>Ethereum's ARIMA parameters were (p=2,d=0,q=0)</strong>. These were validated by the minimization of the root mean squared error.</p> <p><strong>Here is the ARIMA model code:</strong></p> <div class="language-python highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=k>def</span> <span class=nf>ARIMA_predictions</span><span class=p>(</span><span class=n>original_series</span><span class=p>,</span><span class=n>stationary_series</span><span class=p>,</span><span class=n>parameters</span><span class=p>,</span> <span class=n>days_out</span><span class=p>):</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>    <span class=c1># Here we predict the noise</span>
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>    <span class=n>train</span> <span class=o>=</span> <span class=n>stationary_series</span><span class=p>[:</span><span class=o>-</span><span class=n>days_out</span><span class=p>]</span>
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>    <span class=c1># test the model on the last N points of the data, the models I used were at 7 days</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>    <span class=n>test</span> <span class=o>=</span> <span class=n>stationary_series</span><span class=p>[</span><span class=o>-</span><span class=n>days_out</span><span class=p>:]</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>    <span class=c1>#</span>
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>    <span class=n>history</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>train</span><span class=p>]</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>    <span class=n>train</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>    <span class=n>test</span><span class=o>.</span><span class=n>dropna</span><span class=p>(</span><span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-0-11><a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>    <span class=n>predicted_values</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-12><a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>    <span class=n>tested</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-0-13><a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a>
</span><span id=__span-0-14><a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a>    <span class=c1>#1. Plug the noise into the model</span>
</span><span id=__span-0-15><a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a>    <span class=c1>#2. Train the model on the history of the noise</span>
</span><span id=__span-0-16><a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>    <span class=c1>#3. Predict the noise of the next day</span>
</span><span id=__span-0-17><a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a>    <span class=c1>#4. Plug the next day&#39;s predicted noise into the signal function.</span>
</span><span id=__span-0-18><a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a>    <span class=c1>#5. Add the actual price of the next day to the price data set, transform it into stationarity and start again at step 1.</span>
</span><span id=__span-0-19><a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
</span><span id=__span-0-20><a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>test</span><span class=p>)):</span>
</span><span id=__span-0-21><a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>ARIMA</span><span class=p>(</span><span class=n>history</span><span class=p>,</span> <span class=n>order</span><span class=o>=</span><span class=n>parameters</span><span class=p>)</span>
</span><span id=__span-0-22><a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a>        <span class=n>model_fit</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>disp</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-0-23><a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>model_fit</span><span class=o>.</span><span class=n>forecast</span><span class=p>(</span><span class=n>steps</span><span class=o>=</span><span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-0-24><a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a>        <span class=n>predicted_values</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>yhat</span><span class=p>)</span>
</span><span id=__span-0-25><a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a>        <span class=n>tested_values</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>test</span><span class=p>)[</span><span class=n>i</span><span class=p>]</span>
</span><span id=__span-0-26><a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a>        <span class=n>tested</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>tested_values</span><span class=p>)</span>
</span><span id=__span-0-27><a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a>        <span class=n>history</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>tested_values</span><span class=p>)</span>
</span><span id=__span-0-28><a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>    <span class=n>predictions_series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>predicted_values</span><span class=p>,</span> <span class=n>index</span> <span class=o>=</span> <span class=n>test</span><span class=o>.</span><span class=n>index</span><span class=p>)</span>
</span><span id=__span-0-29><a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a>
</span><span id=__span-0-30><a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a>    <span class=c1># This part couples the signal to the noise.</span>
</span><span id=__span-0-31><a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>    <span class=n>a</span> <span class=o>=</span> <span class=n>original_series</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>original_series</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=p>(</span><span class=n>days_out</span><span class=o>+</span><span class=mi>1</span><span class=p>):]][</span><span class=s1>&#39;Price&#39;</span><span class=p>]</span>
</span><span id=__span-0-32><a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>predictions_series</span><span class=p>)</span>
</span><span id=__span-0-33><a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a>    <span class=n>full_predictions</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>b</span><span class=p>,</span><span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Predicted with ARIMA&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span><span id=__span-0-34><a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>original_series</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>original_series</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=n>days_out</span><span class=p>:]],</span><span class=n>full_predictions</span><span class=p>],</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-0-35><a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a>    <span class=n>error</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Price&#39;</span><span class=p>],</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Predicted with ARIMA&#39;</span><span class=p>])))</span>
</span><span id=__span-0-36><a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;ARIMA Root Mean Squared Error: &quot;</span><span class=p>,</span><span class=n>error</span><span class=p>)</span>
</span><span id=__span-0-37><a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a>    <span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=kc>None</span>
</span><span id=__span-0-38><a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>    <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;Price&#39;</span><span class=p>,</span><span class=s1>&#39;Predicted with ARIMA&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;Price&#39;</span><span class=p>,</span><span class=s1>&#39;Predicted with ARIMA&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-0-39><a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>    <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-0-40><a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a>
</span><span id=__span-0-41><a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=n>bitcoin_ARIMA</span> <span class=o>=</span> <span class=n>ARIMA_predictions</span><span class=p>(</span><span class=n>bitcoin</span><span class=p>,</span><span class=n>bits_log_shift</span><span class=p>,(</span><span class=mi>0</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>),</span><span class=mi>7</span><span class=p>)</span>
</span></code></pre></div> <p><strong>Code for Neural Net LSTM</strong></p> <p>The neural net system was based upon sequential, dense LSTM modelling techniques. Like the ARIMA model, it was dependent upon a stationary time series input, modeling the noise and then putting the noise predictions back into the signal. </p> <div class="language-python highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=kn>from</span> <span class=nn>sklearn.preprocessing</span> <span class=kn>import</span> <span class=n>MinMaxScaler</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=kn>from</span> <span class=nn>keras.models</span> <span class=kn>import</span> <span class=n>Sequential</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=kn>from</span> <span class=nn>keras.layers</span> <span class=kn>import</span> <span class=n>Dense</span>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=kn>from</span> <span class=nn>keras.layers</span> <span class=kn>import</span> <span class=n>LSTM</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=k>def</span> <span class=nf>Neural_Net_predictions</span><span class=p>(</span><span class=n>original_time_series</span><span class=p>,</span> <span class=n>stationary_time_series</span><span class=p>,</span> <span class=n>days_out</span><span class=p>,</span><span class=n>nb_epoch</span><span class=p>,</span><span class=n>neurons</span><span class=p>):</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a>    <span class=c1># note all these &quot;sub&quot; functions are used on the stationary time series.</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a>    <span class=c1># The neural nets are used to predict the noise. Once the noise is predicted</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>    <span class=c1># Its plugged back into the signal</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a>    <span class=n>X</span> <span class=o>=</span> <span class=n>stationary_time_series</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a>    <span class=c1># Step 2</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a>    <span class=c1># Break the time series into shifted components. Each column is a shifted value </span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a>    <span class=c1># previously in the time series</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a>    <span class=k>def</span> <span class=nf>timeseries_to_supervised</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>lag</span><span class=o>=</span><span class=mi>1</span><span class=p>):</span>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a>        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a>        <span class=n>columns</span> <span class=o>=</span> <span class=p>[</span><span class=n>df</span><span class=o>.</span><span class=n>shift</span><span class=p>(</span><span class=n>i</span><span class=p>)</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>lag</span><span class=o>+</span><span class=mi>1</span><span class=p>)]</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a>        <span class=n>columns</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a>        <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>(</span><span class=n>columns</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a>        <span class=n>df</span><span class=o>.</span><span class=n>fillna</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=n>inplace</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a>        <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a>    <span class=c1># Step 3</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a>    <span class=c1># We must put the time series onto the scale acceptable by the activation functions</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>    <span class=k>def</span> <span class=nf>scale</span><span class=p>(</span><span class=n>train</span><span class=p>,</span> <span class=n>test</span><span class=p>):</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a>        <span class=n>scaler</span> <span class=o>=</span> <span class=n>MinMaxScaler</span><span class=p>(</span><span class=n>feature_range</span><span class=o>=</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a>        <span class=n>scaler</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>train</span><span class=p>)</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>        <span class=n>train</span> <span class=o>=</span> <span class=n>train</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>train</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a>        <span class=n>train_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>train</span><span class=p>)</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a>        <span class=n>test</span> <span class=o>=</span> <span class=n>test</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>test</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=n>test</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a>        <span class=n>test_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>transform</span><span class=p>(</span><span class=n>test</span><span class=p>)</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>        <span class=k>return</span> <span class=n>scaler</span><span class=p>,</span> <span class=n>train_scaled</span><span class=p>,</span> <span class=n>test_scaled</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>    <span class=c1># Step 4</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a>    <span class=k>def</span> <span class=nf>fit_lstm</span><span class=p>(</span><span class=n>train</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>nb_epoch</span><span class=p>,</span> <span class=n>neurons</span><span class=p>):</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>train</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>train</span><span class=p>[:,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>1</span><span class=p>,</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a>        <span class=n>model</span> <span class=o>=</span> <span class=n>Sequential</span><span class=p>()</span>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a>        <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>LSTM</span><span class=p>(</span><span class=n>neurons</span><span class=p>,</span> <span class=n>batch_input_shape</span><span class=o>=</span><span class=p>(</span><span class=n>batch_size</span><span class=p>,</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=n>X</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>2</span><span class=p>]),</span> <span class=n>stateful</span><span class=o>=</span><span class=kc>True</span><span class=p>))</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a>        <span class=n>model</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>Dense</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a>        <span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>loss</span><span class=o>=</span><span class=s1>&#39;mean_squared_error&#39;</span><span class=p>,</span> <span class=n>optimizer</span><span class=o>=</span><span class=s1>&#39;adam&#39;</span><span class=p>)</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>nb_epoch</span><span class=p>):</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>            <span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>epochs</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>,</span> <span class=n>verbose</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>shuffle</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a>            <span class=n>model</span><span class=o>.</span><span class=n>reset_states</span><span class=p>()</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a>        <span class=k>return</span> <span class=n>model</span>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a>    <span class=c1># Step 5</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a>    <span class=k>def</span> <span class=nf>forecast_lstm</span><span class=p>(</span><span class=n>model</span><span class=p>,</span> <span class=n>batch_size</span><span class=p>,</span> <span class=n>X</span><span class=p>):</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a>        <span class=n>X</span> <span class=o>=</span> <span class=n>X</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>X</span><span class=p>))</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>batch_size</span><span class=o>=</span><span class=n>batch_size</span><span class=p>)</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a>        <span class=k>return</span> <span class=n>yhat</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a>    <span class=c1>#Step 6</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a>    <span class=k>def</span> <span class=nf>invert_scale</span><span class=p>(</span><span class=n>scaler</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span><span id=__span-1-60><a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a>        <span class=n>new_row</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>X</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=n>value</span><span class=p>]</span>
</span><span id=__span-1-61><a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a>        <span class=n>array</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>new_row</span><span class=p>)</span>
</span><span id=__span-1-62><a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a>        <span class=n>array</span> <span class=o>=</span> <span class=n>array</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>array</span><span class=p>))</span>
</span><span id=__span-1-63><a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a>        <span class=n>inverted</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>inverse_transform</span><span class=p>(</span><span class=n>array</span><span class=p>)</span>
</span><span id=__span-1-64><a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a>        <span class=k>return</span> <span class=n>inverted</span><span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-65><a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a>
</span><span id=__span-1-66><a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a>    <span class=c1># Now use all the above functions</span>
</span><span id=__span-1-67><a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a>    <span class=n>supervised</span> <span class=o>=</span> <span class=n>timeseries_to_supervised</span><span class=p>(</span><span class=n>X</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-68><a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a>    <span class=n>supervised_values</span> <span class=o>=</span> <span class=n>supervised</span><span class=o>.</span><span class=n>values</span>
</span><span id=__span-1-69><a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a>    <span class=n>train</span><span class=p>,</span> <span class=n>test</span> <span class=o>=</span> <span class=n>supervised_values</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=o>-</span><span class=n>days_out</span><span class=p>],</span> <span class=n>supervised_values</span><span class=p>[</span><span class=o>-</span><span class=n>days_out</span><span class=p>:]</span>
</span><span id=__span-1-70><a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a>    <span class=n>scaler</span><span class=p>,</span> <span class=n>train_scaled</span><span class=p>,</span> <span class=n>test_scaled</span> <span class=o>=</span> <span class=n>scale</span><span class=p>(</span><span class=n>train</span><span class=p>,</span> <span class=n>test</span><span class=p>)</span>
</span><span id=__span-1-71><a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a>    <span class=n>train_reshaped</span> <span class=o>=</span> <span class=n>train_scaled</span><span class=p>[:,</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>reshape</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>train_scaled</span><span class=p>),</span><span class=mi>1</span><span class=p>,</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-72><a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a>    <span class=n>lstm_model</span> <span class=o>=</span> <span class=n>fit_lstm</span><span class=p>(</span><span class=n>train_scaled</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=n>nb_epoch</span><span class=p>,</span><span class=n>neurons</span><span class=p>)</span>
</span><span id=__span-1-73><a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a>
</span><span id=__span-1-74><a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a>    <span class=c1>#Step 7</span>
</span><span id=__span-1-75><a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a>    <span class=n>predictions</span> <span class=o>=</span> <span class=p>[]</span>
</span><span id=__span-1-76><a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>test_scaled</span><span class=p>)):</span>
</span><span id=__span-1-77><a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a>        <span class=c1>#Make one step forecast</span>
</span><span id=__span-1-78><a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a>        <span class=n>X</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>test_scaled</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=mi>0</span><span class=p>:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>test_scaled</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span><span id=__span-1-79><a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>forecast_lstm</span><span class=p>(</span><span class=n>lstm_model</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=n>X</span><span class=p>)</span>
</span><span id=__span-1-80><a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a>        <span class=c1>#invert scaling</span>
</span><span id=__span-1-81><a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a>        <span class=n>yhat</span> <span class=o>=</span> <span class=n>invert_scale</span><span class=p>(</span><span class=n>scaler</span><span class=p>,</span> <span class=n>X</span><span class=p>,</span> <span class=n>yhat</span><span class=p>)</span>
</span><span id=__span-1-82><a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a>        <span class=c1>#store forecast</span>
</span><span id=__span-1-83><a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a>        <span class=n>predictions</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>yhat</span><span class=p>)</span>
</span><span id=__span-1-84><a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a>
</span><span id=__span-1-85><a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a>    <span class=c1># Step 8</span>
</span><span id=__span-1-86><a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a>    <span class=c1># This part plugs it back into the signal</span>
</span><span id=__span-1-87><a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a>    <span class=n>predictions_series</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>Series</span><span class=p>(</span><span class=n>predictions</span><span class=p>,</span> <span class=n>index</span> <span class=o>=</span> <span class=n>original_time_series</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=n>days_out</span><span class=p>:])</span>
</span><span id=__span-1-88><a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a>    <span class=n>a</span> <span class=o>=</span> <span class=n>original_time_series</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>original_time_series</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=p>(</span><span class=n>days_out</span><span class=o>+</span><span class=mi>1</span><span class=p>):]][</span><span class=s1>&#39;Price&#39;</span><span class=p>]</span>
</span><span id=__span-1-89><a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a>    <span class=n>b</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>exp</span><span class=p>(</span><span class=n>predictions_series</span><span class=p>)</span>
</span><span id=__span-1-90><a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a>    <span class=n>full_predictions</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>DataFrame</span><span class=p>(</span><span class=n>a</span><span class=o>*</span><span class=n>b</span><span class=p>,</span><span class=n>columns</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Predicted with Neural Nets&#39;</span><span class=p>])</span><span class=o>.</span><span class=n>dropna</span><span class=p>()</span>
</span><span id=__span-1-91><a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a>    <span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>concat</span><span class=p>([</span><span class=n>original_time_series</span><span class=o>.</span><span class=n>loc</span><span class=p>[</span><span class=n>original_time_series</span><span class=o>.</span><span class=n>index</span><span class=p>[</span><span class=o>-</span><span class=n>days_out</span><span class=p>:]],</span><span class=n>full_predictions</span><span class=p>],</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-1-92><a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a>    <span class=n>error</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>mean_squared_error</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Price&#39;</span><span class=p>],</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Predicted with Neural Nets&#39;</span><span class=p>])))</span>
</span><span id=__span-1-93><a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Neural Net Root Mean Squared Error: &quot;</span><span class=p>,</span><span class=n>error</span><span class=p>)</span>
</span><span id=__span-1-94><a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a>    <span class=n>df</span><span class=o>.</span><span class=n>index</span><span class=o>.</span><span class=n>name</span><span class=o>=</span><span class=kc>None</span>
</span><span id=__span-1-95><a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a>    <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;Price&#39;</span><span class=p>,</span><span class=s1>&#39;Predicted with Neural Nets&#39;</span><span class=p>]]</span> <span class=o>=</span> <span class=n>df</span><span class=p>[[</span><span class=s1>&#39;Price&#39;</span><span class=p>,</span><span class=s1>&#39;Predicted with Neural Nets&#39;</span><span class=p>]]</span><span class=o>.</span><span class=n>apply</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>round</span><span class=p>(</span><span class=n>x</span><span class=p>,</span><span class=mi>2</span><span class=p>))</span>
</span><span id=__span-1-96><a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a>    <span class=k>return</span> <span class=n>df</span>
</span><span id=__span-1-97><a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a>
</span><span id=__span-1-98><a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a><span class=n>bitcoin_NN</span> <span class=o>=</span> <span class=n>Neural_Net_predictions</span><span class=p>(</span><span class=n>bitcoin</span><span class=p>,</span><span class=n>bits_log_shift</span><span class=p>,</span><span class=n>days_out</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span><span class=n>nb_epoch</span><span class=o>=</span><span class=mi>55</span><span class=p>,</span><span class=n>neurons</span><span class=o>=</span><span class=mi>175</span><span class=p>)</span>
</span></code></pre></div> <p><a href=https://github.com/JoeGanser/Time_Series_Of_Bitcoin_Ethereum>Link to the github repo</a></p> <h2 id=v-sources><strong>V. Sources</strong><a class=headerlink href=#v-sources title="Permanent link">&para;</a></h2> <ol> <li> <p>The Application of Time Series Modelling and Monte Carlo Simulation: Forecasting Volatile Inventory Requirements By Robert Davies, Tim Coole, David Osipyw, <a href=https://file.scirp.org/pdf/AM_2014050513382674.pdf>https://file.scirp.org/pdf/AM_2014050513382674.pdf</a></p> </li> <li> <p>How to Get Started with Deep Learning for Time Series Forecasting (7-Day Mini-Course), by Jason Brownlee; <a href=https://machinelearningmastery.com/how-to-get-started-with-deep-learning-for-time-series-forecasting-7-day-mini-course/ >https://machinelearningmastery.com/how-to-get-started-with-deep-learning-for-time-series-forecasting-7-day-mini-course/</a></p> </li> <li> <p>Statistical forecasting: notes on regression and time series analysis, By Robert Nau, Duke University <a href=https://people.duke.edu/~rnau/411arim.htm>https://people.duke.edu/~rnau/411arim.htm</a></p> </li> </ol> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../2018-10-20-AMES-tutorial/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Real Estate Sales - A basic regression tutorial" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Real Estate Sales - A basic regression tutorial </div> </div> </a> <a href=../../awards_CV/ class="md-footer__link md-footer__link--next" aria-label="Next: Awards" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Awards </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/JoeGanser target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.linkedin.com/in/joe-ganser-aa9b8b132/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "header.autohide", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.2a6f1dda.min.js></script> <script src=../../javascripts/extra.js></script> </body> </html>